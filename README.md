
# üß© MarketplaceEvent ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**MarketplaceEvent** ‚Äî —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –º–æ–¥–µ–ª–∏—Ä—É—é—â–∞—è —Ä–∞–±–æ—Ç—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞.
–û–Ω–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±–º–µ–Ω–∏–≤–∞—é—â–∏—Ö—Å—è —Å–æ–±—ã—Ç–∏—è–º–∏ —á–µ—Ä–µ–∑ **Kafka**, –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **gRPC** –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.

## üöÄ –°–æ—Å—Ç–∞–≤ —Å–∏—Å—Ç–µ–º—ã

| –°–µ—Ä–≤–∏—Å                         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                   | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                                |
| ------------------------------ | ---------------------------------------------------------------------------- | ----------------------------------------- |
| **MarketplaceEvent**           | –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–∫–∞–∑—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka | .NET 8, gRPC, Kafka Producer              |
| **MarketplaceEvent.Analytics** | –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å, —Å–ª—É—à–∞–µ—Ç Kafka-—Ç–æ–ø–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –∑–∞–∫–∞–∑—ã                 | .NET 8, BackgroundService, Kafka Consumer |
| **Kafka / Zookeeper**          | –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–±—ã—Ç–∏—è–º–∏                                        | Confluent Kafka                           |
| **Kafka UI**                   | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç–æ–ø–∏–∫–æ–≤                              | Provectus Kafka UI                        |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```text
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ MarketplaceEvent   ‚îÇ
        ‚îÇ (gRPC API)         ‚îÇ
        ‚îÇ                    ‚îÇ
        ‚îÇ ‚îî‚îÄ> Kafka Producer ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ  (orders-topic)
                 ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ MarketplaceEvent.  ‚îÇ
        ‚îÇ Analytics           ‚îÇ
        ‚îÇ (Kafka Consumer)    ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* **.NET 8**
* **ASP.NET Core gRPC**
* **Kafka (Confluent)**
* **Docker + Docker Compose**
* **Kafka UI** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üõ†Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/<your_username>/MarketplaceEvent.git
cd MarketplaceEvent
```

### 2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
docker compose up --build
```

Docker –ø–æ–¥–Ω–∏–º–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä               | –ü–æ—Ä—Ç         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                    |
| ----------------------- | ------------ | ----------------------------- |
| `zookeeper`             | 2181         | –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è Kafka             |
| `kafka`                 | 9092 / 29092 | –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π              |
| `kafka-ui`              | 8081         | –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Kafka       |
| `marketplace-event`     | 5001         | gRPC API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ |
| `marketplace-analytics` | 5000         | —Å–ª—É—à–∞—Ç–µ–ª—å Kafka, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞    |

---

## üß© –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –°–µ—Ä–≤–∏—Å        | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                | –û–ø–∏—Å–∞–Ω–∏–µ               | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| ------------- | ------------------------- | ---------------------- | --------------------- |
| **–û–±–∞**       | `KAFKA__BOOTSTRAPSERVERS` | –ê–¥—Ä–µ—Å –±—Ä–æ–∫–µ—Ä–∞ Kafka    | `kafka:29092`         |
| **Analytics** | `ASPNETCORE_URLS`         | –ü–æ—Ä—Ç –≤–µ–±-–ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è | `http://+:8080`       |
| **Event**     | `GRPC_PORT`               | –ü–æ—Ä—Ç gRPC API          | `8080`                |

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
MarketplaceEvent/
‚îÇ
‚îú‚îÄ‚îÄ MarketplaceEvent/                      # gRPC API
‚îÇ   ‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrderService.cs                # gRPC-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Protos/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ order.proto                    # –∫–æ–Ω—Ç—Ä–∞–∫—Ç gRPC
‚îÇ   ‚îú‚îÄ‚îÄ Program.cs
‚îÇ   ‚îî‚îÄ‚îÄ MarketplaceEvent.csproj
‚îÇ
‚îú‚îÄ‚îÄ MarketplaceEvent.Analytics/            # –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrderConsumerService.cs        # Kafka Consumer
‚îÇ   ‚îú‚îÄ‚îÄ Program.cs
‚îÇ   ‚îî‚îÄ‚îÄ MarketplaceEvent.Analytics.csproj
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml                     # –æ–±—â–∏–π –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ README.md                              # —ç—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ ...
```

---

## üß† –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker ps
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Kafka UI

–û—Ç–∫—Ä—ã—Ç—å [http://localhost:8081](http://localhost:8081)
‚Üí –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å —Ç–æ–ø–∏–∫ `orders-topic`.

### 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑

–ß–µ—Ä–µ–∑ gRPC-–∫–ª–∏–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, BloomRPC / gRPCurl):

```bash
grpcurl -plaintext -d '{"orderId":"123", "product":"Book", "buyer":"Alice", "amount":59.99}' \
  localhost:5001 MarketplaceEvent.OrderService/CreateOrder
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Analytics

```bash
docker logs -f marketplace-analytics
```

–¢—ã –¥–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å:

```
üü¢ MarketplaceEvent.Analytics —Å–ª—É—à–∞–µ—Ç 'orders-topic'
üì• –ü–æ–ª—É—á–µ–Ω –∑–∞–∫–∞–∑: {"orderId":"123","product":"Book","buyer":"Alice","amount":59.99}
```

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ MarketplaceEvent –∫ —Å–µ—Ç–∏
docker network connect kafka-net MarketplaceEvent

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker compose build --no-cache

# –û—á–∏—Å—Ç–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker compose down -v

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Analytics
docker logs -f marketplace-analytics

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–ø–∏–∫–æ–≤
docker exec -it kafka kafka-topics --list --bootstrap-server kafka:29092
```

---

## üí° Troubleshooting

| –ü—Ä–æ–±–ª–µ–º–∞                      | –†–µ—à–µ–Ω–∏–µ                                                                      |
| ----------------------------- | ---------------------------------------------------------------------------- |
| `1/1 brokers are down`        | Kafka –Ω–µ —É—Å–ø–µ–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è ‚Äî –ø–æ–¥–æ–∂–¥–∏ 10‚Äì20 —Å–µ–∫—É–Ω–¥ –∏–ª–∏ –¥–æ–±–∞–≤—å –æ–∂–∏–¥–∞–Ω–∏–µ –≤ –∫–æ–¥ |
| `–ù–µ –≤–∏–¥–∏—Ç Kafka –∏–∑ Analytics` | –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `KAFKA__BOOTSTRAPSERVERS` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞                  |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è      | –ò—Å–ø–æ–ª—å–∑—É–π `docker compose build --no-cache`                                  |
| –ü—É—Å—Ç—ã–µ –ª–æ–≥–∏                   | –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `OrderConsumerService` –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `Program.cs`           |

---